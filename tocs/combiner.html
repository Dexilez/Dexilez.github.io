<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Talisman Online Combine Simulator</title>
    <link rel="stylesheet" href="combiner.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300&display=swap" rel="stylesheet">
</head>
<body>

<div class="login" id="login">
    <form class="login-form">
        <p></p><label for="nickname">Player Name: </label>
        <br><input class="player-name-value" placeholder="" type="text">
        <p></p><label for="class">Class: </label>
        <br><select class="player-class-value" name="classes" id="classes">
            <option value="Assassin">Assassin</option>
            <option value="Monk">Monk</option>
            <option value="Fairy">Fairy</option>
            <option value="Wizard">Wizard</option>
            <option value="Tamer">Tamer</option>
        </select>
        <p></p><input class="login-button" type="submit" value="Login">
    </form>
</div>

<div class="info">
    <div class="character" id="character-content">
    </div>
</div>


<div class="combine" id="combine">
</div>

<div class="button">
    <button class="combine-button" type="submit" onclick="combine()">Combine</button>
</div>

<div class="chat" id="chat">
    <div class="system">
        <div class="system-title">[system]: </div>
        <div class="system-content"> Welcome to Talisman Online Combine Simulator!</div>
    </div>
</div>

</body>

<script>

    var nick = localStorage.getItem("player-nick");
    var photoClass = localStorage.getItem("player-class");
    var loginStatus = localStorage.getItem("isLogin");
    if (nick === null || nick === "" || photoClass === null || photoClass === "") {
            // do nothing
        } else {
            if (photoClass === "Assassin") {
                document.getElementById("character-content").innerHTML = "<div class='photo-level'><span class='photo' id='photo-class'><img class='img-char' src='image/assassin.jpg'></span><span class='level'>80</span></div><div class='info-char'><div class='char-name'><span class='nickname' id='nickname'>" + nick + "</span></div><div class='health'>50000/50000</div><div class='resource green'>100/100</div></div><div class='logout' id='logout'><button class='logout-button'>Logout</button></div></div>";
                document.getElementById("combine").innerHTML = "<div class='gem' id='gem'><span><img width='50px' src='image/se.jpg'></span></div><div class='plus' id='plus'><span>+0</span></div><div class='talisman' id='talisman'><span><img width='50px' src='image/dsd.jpg'></span></div>";
                var weaponName = "Dragon Soul Dagger";
            } else if (photoClass === "Monk") {
                document.getElementById("character-content").innerHTML = "<div class='photo-level'><span class='photo' id='photo-class'><img class='img-char' src='image/monk.jpg'></span><span class='level'>80</span></div><div class='info-char'><div class='char-name'><span class='nickname' id='nickname'>" + nick + "</span></div><div class='health'>50000/50000</div><div class='resource green'>100/100</div></div><div class='logout' id='logout'><button class='logout-button'>Logout</button></div></div>";
                document.getElementById("combine").innerHTML = "<div class='gem' id='gem'><span><img width='50px' src='image/se.jpg'></span></div><div class='plus' id='plus'><span>+0</span></div><div class='talisman' id='talisman'><span><img width='50px' src='image/wts.jpg'></span></div>";
                var weaponName = "Wonder Tree Staff";
            } else if (photoClass === "Fairy") {
                document.getElementById("character-content").innerHTML = "<div class='photo-level'><span class='photo' id='photo-class'><img class='img-char' src='image/fairy.jpg'></span><span class='level'>80</span></div><div class='info-char'><div class='char-name'><span class='nickname' id='nickname'>" + nick + "</span></div><div class='health'>50000/50000</div><div class='resource blue'>20000/20000</div></div><div class='logout' id='logout'><button class='logout-button'>Logout</button></div></div>";
                document.getElementById("combine").innerHTML = "<div class='gem' id='gem'><span><img width='50px' src='image/se.jpg'></span></div><div class='plus' id='plus'><span>+0</span></div><div class='talisman' id='talisman'><span><img width='50px' src='image/ntw.jpg'></span></div>";
                var weaponName = "Naga Treasure Wheel";
            } else if (photoClass === "Tamer") {
                document.getElementById("character-content").innerHTML = "<div class='photo-level'><span class='photo' id='photo-class'><img class='img-char' src='image/tamer.jpg'></span><span class='level'>80</span></div><div class='info-char'><div class='char-name'><span class='nickname' id='nickname'>" + nick + "</span></div><div class='health'>50000/50000</div><div class='resource blue'>20000/20000</div></div><div class='logout' id='logout'><button class='logout-button'>Logout</button></div></div>";
                document.getElementById("combine").innerHTML = "<div class='gem' id='gem'><span><img width='50px' src='image/se.jpg'></span></div><div class='plus' id='plus'><span>+0</span></div><div class='talisman' id='talisman'><span><img width='50px' src='image/cmb.jpg'></span></div>";
                var weaponName = "Cold Moon Bow";
            } else if (photoClass === "Wizard") {
                document.getElementById("character-content").innerHTML = "<div class='photo-level'><span class='photo' id='photo-class'><img class='img-char' src='image/wizard.jpg'></span><span class='level'>80</span></div><div class='info-char'><div class='char-name'><span class='nickname' id='nickname'>" + nick + "</span></div><div class='health'>50000/50000</div><div class='resource blue'>20000/20000</div></div><div class='logout' id='logout'><button class='logout-button'>Logout</button></div></div>";
                document.getElementById("combine").innerHTML = "<div class='gem' id='gem'><span><img width='50px' src='image/se.jpg'></span></div><div class='plus' id='plus'><span>+0</span></div><div class='talisman' id='talisman'><span><img width='50px' src='image/hws.jpg'></span></div>";
                var weaponName = "Howling Wind Sword";
            }
        }

    if (loginStatus) {
        document.getElementById("login").setAttribute("class", "hidden");
    } else {
        // do nothing :)
    }

    const randomMessageList = [
        "CWC 3/5 need fay <img width= 24px height= 24px src='image/9.gif'>",
        "i need 5g. anyone please? <img width= 24px height= 24px src='image/10.gif'>",
        "team me reset <img width= 24px height= 24px src='image/11.gif'>",
        "sell tp 1000g check auction <img width= 24px height= 24px src='image/1.gif'>",
        "MDV daily 1/5 <img width= 24px height= 24px src='image/11.gif'>",
        "anarchy dogssss kkkkkkkkkk <img width= 24px height= 24px src='image/3.gif'>",
        "i am red come find me noobs <img width= 24px height= 24px src='image/7.gif'>",
        "buy LE 400g each pm me <img width= 24px height= 24px src='image/5.gif'>",
        "admin pm me <img width= 24px height= 24px src='image/8.gif'>",
        "sell alt weps +10 offertas pm me <img width= 24px height= 24px src='image/6.gif'>"
    ]
    var lengthMessages = randomMessageList.length;

    const randomNicks = [
        "XaZaX",
        "pr0d1gy",
        "madd0g",
        "Dex",
        "Dexilez",
        "Dexter",
        "Minkyun",
        "Glitch Supernova",
        "sniper_tr",
        "ZaLiii",
        "Kaien",
        "oceilot",
        "ocelote",
        "anahatma",
        "cradlef",
        "blessed mother"
    ]
    var lengthNicks = randomNicks.length;

    let weapon = 0;
    const loginButton = document.querySelector(".login-button");
    const logoutButton = document.querySelector(".logout-button");
    const loginForm = document.querySelector(".login-form");

    function diceLuck(min,max){
        return Math.floor(Math.random()*(max-min+1)+min);
    }

    function randomNum(min,max){
        return Math.floor(Math.random()*(max-min+1)+min);
    }

    function updateScroll(){
        var element = document.getElementById("chat");
        element.scrollTop = element.scrollHeight;
    }

    function gratsMessages () {
        var nicknameRandomNum = randomNum(0,lengthNicks-1);
        document.getElementById("chat").innerHTML += "<div class='world'><div class='world-title'>[world]: </div><div class='world-content'> [" + randomNicks[nicknameRandomNum] + "]: gzzzz <img width= 24px height= 24px src='image/1.gif'></div></div>";
        updateScroll();
    }

    function failMessages () {
        var nicknameRandomNum = randomNum(0,lengthNicks-1);
        document.getElementById("chat").innerHTML += "<div class='world'><div class='world-title'>[world]: </div><div class='world-content'> [" + randomNicks[nicknameRandomNum] + "]: <img width= 24px height= 24px src='image/2.gif'></div></div>";
        updateScroll();
    }

    function randomMessages() {
        var messageRandomNum = randomNum(0,lengthMessages-1);
        var nicknameRandomNum = randomNum(0,lengthNicks-1);
        document.getElementById("chat").innerHTML += "<div class='world'><div class='world-title'>[world]: </div><div class='world-content'> [" + randomNicks[nicknameRandomNum] + "]: " + randomMessageList[messageRandomNum] + "</div></div>";
        updateScroll();
    }
    setInterval(randomMessages, 60000);

    function combine() {
        if (loginStatus) {
            if (weapon <= 3) {
            var luck = diceLuck(0,100);
            console.log(luck);
            if (luck < 20) {
                var weaponFailedTo = weapon+1;
                document.getElementById("chat").innerHTML += "<div class='rumor'><div class='rumor-title'>[rumor]: </div><div class='rumor-content'> Something unexpected happened!" + " [" + nick + "]" + " failed while trying to combine <span class='rumor-item'>[" + weaponName + "] to +" + weaponFailedTo + ".</div></div>";
                failMessages();
                updateScroll();
            } else {
                weapon++;
                document.getElementById("chat").innerHTML += "<div class='rumor'><div class='rumor-title'>[rumor]: </div><div class='rumor-content'>Incredible!" + " [" + nick + "]" + " combined <span class='rumor-item'>[" + weaponName + "]</span> to +" + weapon + " successfully!</div></div>";
                document.getElementById("plus").innerHTML = "<span>+" + weapon + "</span>";
                gratsMessages();
                updateScroll();
                if (weapon === 3) {
                    document.getElementById("gem").innerHTML = "<span><img src='image/me.jpg' width='50px'></span>";
                }
            }
        } else if (weapon <= 6) {
            var luck = diceLuck(0,75);
            console.log(luck);
            if (luck < 50) {
                var weaponFailedTo = weapon+1;
                document.getElementById("chat").innerHTML += "<div class='rumor'><div class='rumor-title'>[rumor]: </div><div class='rumor-content'> Something unexpected happened!" + " [" + nick + "]" + " failed while trying to combine <span class='rumor-item'>[" + weaponName + "] to +" + weaponFailedTo + ".</div></div>";
                failMessages();
                updateScroll();
            } else {
                weapon++;
                document.getElementById("chat").innerHTML += "<div class='rumor'><div class='rumor-title'>[rumor]: </div><div class='rumor-content'>Incredible!" + " [" + nick + "]" + " combined <span class='rumor-item'>[" + weaponName + "]</span> to +" + weapon + " successfully!</div></div>";
                document.getElementById("plus").innerHTML = "<span>+" + weapon + "</span>";
                gratsMessages();
                updateScroll();
                if (weapon === 6) {
                    document.getElementById("gem").innerHTML = "<span><img src='image/le.jpg' width='50px'></span>";
                }
            }
        } else if (weapon === 7) {
            var luck = diceLuck(0,65);
            console.log(luck);
            if (luck < 50) {
                var weaponFailedTo = weapon+1;
                document.getElementById("chat").innerHTML += "<div class='rumor'><div class='rumor-title'>[rumor]: </div><div class='rumor-content'> Something unexpected happened!" + " [" + nick + "]" + " failed while trying to combine <span class='rumor-item'>[" + weaponName + "] to +" + weaponFailedTo + ".</div></div>";
                failMessages();
                updateScroll();
            } else {
                weapon++;
                document.getElementById("chat").innerHTML += "<div class='rumor'><div class='rumor-title'>[rumor]: </div><div class='rumor-content'>Incredible!" + " [" + nick + "]" + " combined <span class='rumor-item'>[" + weaponName + "]</span> to +" + weapon + " successfully!</div></div>";
                document.getElementById("plus").innerHTML = "<span>+" + weapon + "</span>";
                gratsMessages();
                updateScroll();
            }
        } else if (weapon === 8) {
            var luck = diceLuck(0,60);
            console.log(luck);
            if (luck < 50) {
                var weaponFailedTo = weapon+1;
                document.getElementById("chat").innerHTML += "<div class='rumor'><div class='rumor-title'>[rumor]: </div><div class='rumor-content'> Something unexpected happened!" + " [" + nick + "]" + " failed while trying to combine <span class='rumor-item'>[" + weaponName + "] to +" + weaponFailedTo + ".</div></div>";
                failMessages();
                updateScroll();
            } else {
                weapon++;
                document.getElementById("chat").innerHTML += "<div class='rumor'><div class='rumor-title'>[rumor]: </div><div class='rumor-content'>Incredible!" + " [" + nick + "]" + " combined <span class='rumor-item'>[" + weaponName + "]</span> to +" + weapon + " successfully!</div></div>";
                document.getElementById("plus").innerHTML = "<span>+" + weapon + "</span>";
                gratsMessages();
                updateScroll();
            }
        } else if (weapon === 9) {
            var luck = diceLuck(0,55);
            console.log(luck);
            if (luck < 50) {
                var weaponFailedTo = weapon+1;
                document.getElementById("chat").innerHTML += "<div class='rumor'><div class='rumor-title'>[rumor]: </div><div class='rumor-content'> Something unexpected happened!" + " [" + nick + "]" + " failed while trying to combine <span class='rumor-item'>[" + weaponName + "] to +" + weaponFailedTo + ".</div></div>";
                failMessages();
                updateScroll();
            } else {
                weapon++;
                document.getElementById("chat").innerHTML += "<div class='rumor'><div class='rumor-title'>[rumor]: </div><div class='rumor-content'>Incredible!" + " [" + nick + "]" + " combined <span class='rumor-item'>[" + weaponName + "]</span> to +" + weapon + " successfully!</div></div>";
                document.getElementById("plus").innerHTML = "<span>+" + weapon + "</span>";
                gratsMessages();
                updateScroll();
            }
        } else if (weapon >= 10) {
            document.getElementById("chat").innerHTML += "<div class='system'><div class='system-title'>[system]: </div><div class='system-content'> +10 oldun zaten garda≈ü</div></div>";
            updateScroll();
        }
        } else {
            document.getElementById("chat").innerHTML += "<div class='system'><div class='system-title'>[system]: </div><div class='system-content'> You need to login. </div></div>";
            updateScroll();
        }
    }

    loginButton.addEventListener("click", function () {
        event.preventDefault();
        var playerName = document.querySelector(".player-name-value").value;
        console.log(playerName);
        var playerClass = document.querySelector(".player-class-value").value;
        console.log(playerClass);
        if (playerName === null || playerName === "") {
            // do nothing
        } else {
            event.preventDefault();
            localStorage.setItem("player-nick", playerName);
            localStorage.setItem("player-class", playerClass);
            localStorage.setItem("isLogin", true);
            loginForm.reset();
            location.reload();
        }
    });

    logoutButton.addEventListener("click", function () {
            event.preventDefault();
            localStorage.clear();
            location.reload();
    });

</script>
</html>